181Q. Employees Earning More Than Their Managers


-- ✅ 1. Self Join (Straightforward and Clear)
SELECT e.name 
FROM Employee e
JOIN Employee m ON e.managerId = m.id
WHERE e.salary > m.salary;

SELECT e.name 
FROM Employee e
JOIN Employee m ON e.managerId = m.id
WHERE e.salary > m.salary;




-- ✅ 2. CTE (Common Table Expression) — For Readability
WITH EmpWithManagers AS (
  SELECT e.EmployeeID, e.Name AS EmployeeName, e.Salary AS EmployeeSalary,
         m.EmployeeID AS ManagerID, m.Name AS ManagerName, m.Salary AS ManagerSalary
  FROM Employees e
  JOIN Employees m ON e.ManagerID = m.EmployeeID
)
SELECT *
FROM EmpWithManagers
WHERE EmployeeSalary > ManagerSalary;

-- ✅ 3. Subquery in WHERE Clause — Simple & Elegant
SELECT e.EmployeeID, e.Name, e.Salary, e.ManagerID
FROM Employees e
WHERE e.Salary > (
    SELECT Salary
    FROM Employees
    WHERE EmployeeID = e.ManagerID
);

-- ✅ 4. EXISTS — Efficient for Large Datasets
SELECT e.EmployeeID, e.Name, e.Salary, e.ManagerID
FROM Employees e
WHERE EXISTS (
    SELECT 1
    FROM Employees m
    WHERE m.EmployeeID = e.ManagerID
      AND e.Salary > m.Salary
);

-- ✅ 5. CROSS APPLY — Row-wise Logical Power
SELECT e.EmployeeID, e.Name AS Employee, e.Salary AS EmployeeSalary,
       m.Name AS Manager, m.Salary AS ManagerSalary
FROM Employees e
CROSS APPLY (
    SELECT m.Name, m.Salary
    FROM Employees m
    WHERE m.EmployeeID = e.ManagerID
) m
WHERE e.Salary > m.Salary;
